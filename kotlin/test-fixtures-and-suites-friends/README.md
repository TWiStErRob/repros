https://youtrack.jetbrains.com/issue/KT-34901

All the problematic parts are flagged with `// RED` comments.
